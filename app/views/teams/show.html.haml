%h1= @team.name
- if policy(@team).edit?
  %p= link_to "Edit this team", edit_team_url(@team)

.row-fluid
  .span12
    %h4
      Team Members
    %table.table
      %thead
        %tr
          %th Name
          %th Username
          %th Email
      %tbody
        - @team.users.each do |user|
          %tr
            %td= user.name
            %td
              %img{src: user.image_url(25), alt: 'Gravatar'}
              = link_to user.username, user_url(user.id)
            %td= mail_to user.email
.row-fluid
  .span12
    %h4 Jenkins server
    - if @jenkins_server
      %table.table
        %thead
          %tr
            %th ID
            %th Address
            %th Status
            %th OS
            %th URL
          = render partial: 'jenkins_instance', collection: [@jenkins_server]
      %h5= link_to_new_slave(@jenkins_server)
      - if @jenkins_slaves && @jenkins_slaves.size > 0
        %h4 Jenkins slaves
        %table.table
          %thead
            %tr
              %th ID
              %th Address
              %th Status
              %th OS
          = render partial: 'jenkins_instance', collection: @jenkins_slaves
        %h5= link_to_new_slave(@jenkins_server)
    - elsif policy(@team.build_jenkins_server).create?
      %p= link_to "Create a new jenkins server", new_jenkins_server_url

.row-fluid
  .span12
    - if @ec2_instances.size > 0
      %h4 Instances
      %table.table
        %thead
          %tr
            %th ID
            %th Name
            %th Status
            %th OS
            %th Environment
        = render partial: 'shared/ec2_instance_row', collection: @ec2_instances

    - if policy(@team.ec2_instances.build).create?
      %h4 EC2 Instance Control
      %p= link_to "Launch New Instance", new_aws_ec2_instance_url(team_id: params[:id])
.row-fluid
  .span12
    %h4 Environments
    - if @environments
      %table.table
        %tr
          %th Name
          %th Environment type
        = render partial: 'environment', collection: @environments
    - if policy(@environments.build).create?
      %p= link_to "Create a new environment", new_team_environment_url(@team)
- if policy(@team).deactivate?
  %button.button.close{data: {toggle: 'modal', target: '.deactivate_modal'}} Deactivate
  .deactivate_modal.modal.fade{tabindex: -1, role: 'dialog', aria_labelledby: "Deactivate Team #{@team.name}", aria_hidden: true, style: 'display: none;'}
    .modal-dialog
      .modal-content
        = simple_form_for @team, url: deactivate_team_url(@team), method: :post do |f|
          .modal-header
            %button.close{data: {dismiss: 'modal'}, aria_hidden: true}
              &times;
            %h4.modal-title= "Deactivate #{@team.name}"
          .modal-body
            %p.text-warning
              Deactivation will hide team and make impossible to create instances in it
            = label_tag :confirm, "Please confirm with team name"
            = text_field_tag :confirm, "",data: {confirmation: @team.name}
          .modal-footer
            = f.submit "Confirm", { disabled: 'disabled', class: 'btn btn-danger'}

